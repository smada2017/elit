<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="CS 1331">
  <title>Classes</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/gt.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">Classes</h1>
  <h2 class="author">CS 1331</h2>
</section>

<section id="classes" class="slide level1">
<h1>Classes</h1>
<center>
<iframe width="420" height="315" src="https://www.youtube.com/embed/8aXsEO2eKo4" frameborder="0" allowfullscreen>
</iframe>
</center>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="anatomy-of-a-class" class="slide level1">
<h1>Anatomy of a Class</h1>
<p>By the end of next lecture, you'll understand everything in this class definition.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">package edu.gatech.cs1331.card;</span>

<span class="kw">import java.util.Arrays;</span>

<span class="kw">public</span> <span class="kw">class</span> Card {

  <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> String[] VALID_RANKS = {<span class="st">&quot;2&quot;</span>, <span class="kw">... </span>, <span class="st">&quot;ace&quot;</span>};
  <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> String[] VALID_SUITS = {<span class="st">&quot;diamonds&quot;</span>, <span class="kw">... </span>};
  <span class="kw">private</span> String rank;
  <span class="kw">private</span> String suit;

  <span class="kw">public</span> <span class="fu">Card</span>(String aRank, String aSuit) {
    <span class="co">// ...</span>
  }
  <span class="kw">public</span> String <span class="fu">toString</span>() {
    <span class="kw">return</span> rank + <span class="st">&quot; of &quot;</span> + suit;
  }
  <span class="kw">private</span> <span class="dt">boolean</span> <span class="fu">isValidRank</span>(String someRank) { <span class="kw">... </span>}
}</code></pre></div>
</section>
<section id="the-card-class-example" class="slide level1">
<h1>The Card Class Example</h1>
<p>In this two-part lecture we'll use a running example stored in a Git repo. Go to <a href="https://github.com/cs1331/card" class="uri">https://github.com/cs1331/card</a>, click on &quot;Clone or download&quot; and copy the clone URL. Then open your terminal and do this:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="kw">cd</span> cs1331
<span class="kw">git</span> clone https://github.com/cs1331/card.git
<span class="kw">cd</span> card</code></pre></div>
<p>Note that if you've uplaoded your public SSH key you may use an SSH clone URL.</p>
<p>Now you're ready to follow along.</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="a-card-class-v0.01" class="slide level1">
<h1>A Card Class, v0.0<sup><a href="http://semver.org/">1</a></sup></h1>
<p>Consider how to represent a Card ADT:</p>
<ul>
<li>rank - the rank of a playing card, e.g., 2, jack, ace</li>
<li>suit - the suit of a playing card, e.g., spades, diamonds</li>
</ul>
<p>Here's how you would check out version 0.0:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="kw">git</span> checkout v0.0</code></pre></div>
<p>1 <a href="http://semver.org/">Semantic Versioning</a></p>
</section>
<section id="card-v0.0" class="slide level1">
<h1><code>Card</code>, v0.0</h1>
<p>And your <code>Card.java</code> will then contain:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {

    String rank;
    String suit;
}</code></pre></div>
<ul>
<li><code>rank</code> and <code>suit</code> are instance variables</li>
<li>Every <em>instance</em> of <code>Card</code> has its own copy of instance variables.</li>
</ul>
<p>Let's &quot;do something&quot; with <code>Card</code> by adding a main method and bumping to v0.1.</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="card-v0.1" class="slide level1">
<h1><code>Card</code> v0.1</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {

    String rank;
    String suit;

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>Note that we can put a <code>main</code> method in any class. This is useful for exploratory testing, like we're doing here.</p>
<p>The <code>String</code> representation isn't very appealing. (What does it print?)</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="card-v0.2" class="slide level1">
<h1><code>Card</code> v0.2</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    String rank;
    String suit;

    <span class="kw">public</span> String <span class="fu">toString</span>() {
        <span class="kw">return</span> rank + <span class="st">&quot; of &quot;</span> + suit;
    }
    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card swedishPop = <span class="kw">new</span> <span class="fu">Card</span>();
        swedishPop.<span class="fu">rank</span> = <span class="st">&quot;ace&quot;</span>;
        swedishPop.<span class="fu">suit</span> = <span class="st">&quot;base&quot;</span>;
        Card handy = <span class="kw">new</span> <span class="fu">Card</span>();
        handy.<span class="fu">rank</span> = <span class="st">&quot;jack&quot;</span>;
        handy.<span class="fu">suit</span> = <span class="st">&quot;all trades&quot;</span>;
        System.<span class="fu">out</span>.<span class="fu">println</span>(swedishPop);
        System.<span class="fu">out</span>.<span class="fu">println</span>(handy);
    }
}</code></pre></div>
<p>Now we have a nice <code>String</code> representation, but we havve an &quot;ace of base&quot; card and a &quot;jack of all trades&quot;, which aren't valid cards.</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="encapsulation-card-v1.0" class="slide level1">
<h1>Encapsulation: Card, v1.0</h1>
<p>Let's protect the instance variables by making them private:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    <span class="kw">private</span> String rank;
    <span class="kw">private</span> String suit;

    <span class="kw">public</span> String <span class="fu">toString</span>() {
        <span class="kw">return</span> rank + <span class="st">&quot; of &quot;</span> + suit;
    }

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        c.<span class="fu">rank</span> = <span class="st">&quot;ace&quot;</span>;
        c.<span class="fu">suit</span> = <span class="st">&quot;base&quot;</span>;
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>Why does this still compile?</p>
<ul>
<li><code>main</code> method in <code>Card</code> -- can see <code>Card</code>'s private parts</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="a-dealer-class-v1.1" class="slide level1">
<h1>A Dealer Class, v1.1</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        c.<span class="fu">rank</span> = <span class="st">&quot;ace&quot;</span>;
        c.<span class="fu">suit</span> = <span class="st">&quot;base&quot;</span>;
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>This won't compile (which is what we want). Why?</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="mutators-card-v1.2" class="slide level1">
<h1>Mutators: Card, v1.2</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {

    <span class="kw">private</span> String rank;
    <span class="kw">private</span> String suit;

    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setRank</span>(String rank) {
        rank = rank;
    }
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setSuit</span>(String suit) {
        suit = suit;
    }
}</code></pre></div>
<ul>
<li>Now client code can set the rank and suit of a card by calling <code>setRank</code> and <code>setSuit</code>.</li>
<li><code>setX</code> is the Java convention for a setter method for an instance variable named <code>x</code>.</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="dealing-card-v1.2" class="slide level1">
<h1>Dealing <code>Card</code>, v1.2</h1>
<p>Let's try out our new <code>Card</code> class.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        c.<span class="fu">setRank</span>(<span class="st">&quot;ace&quot;</span>);
        c.<span class="fu">setSuit</span>(<span class="st">&quot;base&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>Oops. Prints &quot;null of null&quot;. Why?</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="shadowing-variables" class="slide level1">
<h1>Shadowing Variables</h1>
<p>The parameters in the setters &quot;shadowed&quot; the instance variables:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">void</span> <span class="fu">setRank</span>(String rank) {
    rank = rank;
}

<span class="kw">public</span> <span class="dt">void</span> <span class="fu">setSuit</span>(String suit) {
    suit = suit;
}</code></pre></div>
<ul>
<li><code>rank</code> in <code>setRank</code> refers to the local <code>rank</code> variable, not the instance variable of the same name</li>
<li><code>suit</code> in <code>setSuit</code> refers to the local <code>suit</code> variable, not the instance variable of the same name</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="dealing-with-this-card-v1.2.1" class="slide level1">
<h1>Dealing with <code>this</code>: Card, v1.2.1</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    <span class="kw">private</span> String rank;
    <span class="kw">private</span> String suit;

    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setRank</span>(String rank) {
        <span class="kw">this</span>.<span class="fu">rank</span> = rank;
    }
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setSuit</span>(String suit) {
        <span class="kw">this</span>.<span class="fu">suit</span> = suit;
    }
}</code></pre></div>
<ul>
<li>Every instance of a class has a <code>this</code> reference which refers to the instance on which a method is being called.</li>
<li><code>this.rank</code> refers to the <code>rank</code> instance variable for the <code>Card</code> instance on which <code>setRank</code> is being called.</li>
<li><code>this.rank</code> is different from the local <code>rank</code> variable that is a parameter to the <code>setRank</code> method.</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="dealing-card-v1.2.1" class="slide level1">
<h1>Dealing <code>Card</code>, v1.2.1</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        c.<span class="fu">setRank</span>(<span class="st">&quot;ace&quot;</span>);
        c.<span class="fu">setSuit</span>(<span class="st">&quot;base&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>Now we have encapsulation, but we can still create invalid <code>Card</code>s, e.g., &quot;base&quot; is not a valid suit. How to fix?</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="class-invariants" class="slide level1">
<h1>Class Invariants</h1>
<p>Class invariant: a condition that must hold for all instances of a class in order for instances of the class to be considered valid.</p>
<p>Invariants for Card class:</p>
<ul>
<li><code>rank</code> must be one of {&quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;jack&quot;, &quot;queen&quot;, &quot;king&quot;, &quot;ace&quot;}</li>
<li><code>suit</code> must be one of {&quot;diamonds&quot;, &quot;clubs&quot;, &quot;hearts&quot;,&quot;spades&quot;}</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="class-invariants-card-v1.3" class="slide level1">
<h1>Class Invariants: Card v1.3</h1>
<p><code>rank</code> invariant can be maintained by adding:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    <span class="kw">private</span> <span class="dt">final</span> String[] VALID_RANKS =
        {<span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>,
         <span class="st">&quot;10&quot;</span>, <span class="st">&quot;jack&quot;</span>, <span class="st">&quot;queen&quot;</span>, <span class="st">&quot;king&quot;</span>, <span class="st">&quot;ace&quot;</span>};
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setRank</span>(String rank) {
        <span class="kw">if</span> (!<span class="fu">isValidRank</span>(rank)) {
            System.<span class="fu">out</span>.<span class="fu">println</span>(rank + <span class="st">&quot; is not a valid rank.&quot;</span>);
            System.<span class="fu">exit</span>(<span class="dv">0</span>);
        }
        <span class="kw">this</span>.<span class="fu">rank</span> = rank;
    }
    <span class="kw">private</span> <span class="dt">boolean</span> <span class="fu">isValidRank</span>(String someRank) {
        <span class="kw">return</span> <span class="fu">contains</span>(VALID_RANKS, someRank);
    }
    <span class="kw">private</span> <span class="dt">boolean</span> <span class="fu">contains</span>(String[] array, String item) {
        <span class="kw">for</span> (String element: array) {
            <span class="kw">if</span> (element.<span class="fu">equals</span>(item)) {
                <span class="kw">return</span> <span class="kw">true</span>;
            }
        }
        <span class="kw">return</span> <span class="kw">false</span>;
    }
    <span class="co">// ...</span>
}</code></pre></div>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="class-invariants-ensure-consistent-objects" class="slide level1">
<h1>Class Invariants Ensure Consistent Objects</h1>
<p>Now we can't write code that instantiates an invalid <code>Card</code> object:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {
    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        c.<span class="fu">setRank</span>(<span class="st">&quot;ace&quot;</span>);
        c.<span class="fu">setSuit</span>(<span class="st">&quot;base&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>yields:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">java</span> Dealer
<span class="kw">base</span> is not a valid suit.</code></pre></div>
</section>
<section id="dealer-v1.3.1" class="slide level1">
<h1><code>Dealer</code> v1.3.1</h1>
<p>Version 1.3.1 fixes the invalid suit:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        c.<span class="fu">setRank</span>(<span class="st">&quot;ace&quot;</span>);
        c.<span class="fu">setSuit</span>(<span class="st">&quot;spades&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="initializing-instances-v1.4" class="slide level1">
<h1>Initializing Instances (v1.4)</h1>
<p><code>Card</code> now ensures that we don't create card objects with invalid ranks or suits. But consider this slight modification to <code>Dealer</code> in v1.4:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer5 {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        System.<span class="fu">out</span>.<span class="fu">println</span>(c); <span class="co">// Printing a new Card instance</span>
        c.<span class="fu">setRank</span>(<span class="st">&quot;ace&quot;</span>);
        c.<span class="fu">setSuit</span>(<span class="st">&quot;base&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>What if we printed our <code>Card</code> instance, <code>c</code>, before we called the setters?</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="object-initialization" class="slide level1">
<h1>Object Initialization</h1>
<p>Two ways to initialize the instance variables of an object:</p>
<ul>
<li>Declaration point initialization:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    <span class="kw">private</span> String rank = <span class="st">&quot;2&quot;</span>;
    <span class="co">// ...</span>
}</code></pre></div>
<ul>
<li>Constructors</li>
</ul>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    <span class="kw">public</span> <span class="fu">Card</span>() {
      rank = <span class="st">&quot;2&quot;</span>;
    }
    <span class="co">// ...</span>
}</code></pre></div>
<p>A constructor is what's being called when you invoke operator <code>new</code>.</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="initializing-objects" class="slide level1">
<h1>Initializing Objects</h1>
<p>Since we didn't write our own constructor, Java provided a default no-arg constructor - default no-arg ctor sets instance variables (that don't have their own declaration-point intializations) to their default values.</p>
<p>That's why <code>Card</code> objects are <code>null of null</code> after they're instantiated. We have to call the setters on a <code>Card</code> instance before we have a valid object.</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="innitialization-style" class="slide level1">
<h1>Innitialization Style</h1>
<p>In general, it's poor style to require multi-step initialization.</p>
<ul>
<li>After <code>new Card()</code> is called, instance variables have useless defaults.</li>
<li>Client programmer must remember to call setter methods.</li>
<li>Often there can be order dependencies that we don't want to burden client programmers with.</li>
</ul>
<p>The way to fix this is by writing our own constructor.</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="a-constructor-for-card-v2.0" class="slide level1">
<h1>A Constructor for Card, v2.0</h1>
<p>If we write a constructor, Java won't provide a default no-arg constructor. (We may choose to provide one.)</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Card {
    <span class="co">// ...</span>
    <span class="kw">public</span> <span class="fu">Card</span>(String rank, String suit) {
        <span class="fu">setRank</span>(rank);
        <span class="fu">setSuit</span>(suit);
    }
    <span class="co">// ...</span>
}</code></pre></div>
</section>
<section id="dealer-v2.0" class="slide level1">
<h1><code>Dealer</code> v2.0</h1>
<p>Now this won't even compile:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>();
        <span class="co">// ...</span>
    }
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">$ <span class="kw">javac</span> Dealer.java
<span class="kw">Dealer.java</span>:4: error: constructor Card in class Card cannot be applied to given types<span class="kw">;</span>
        <span class="kw">Card</span> c = new Card();
                 ^
  <span class="kw">required</span>: String,String
  <span class="kw">found</span>: no arguments
  <span class="kw">reason</span>: actual and formal argument lists differ in length
<span class="kw">1</span> error</code></pre></div>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="using-the-card-v2.0.1-constructor" class="slide level1">
<h1>Using the Card v2.0.1 Constructor</h1>
<p>Now we have a safer, more consistent way to initialize objects:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>(<span class="st">&quot;queen&quot;</span>, <span class="st">&quot;hearts&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="intermission" class="slide level1">
<h1>Intermission</h1>
<center>
<img src="AceofBaseTheSignAlbumcover.jpg" />
</center>
<p>Source: <a href="http://en.wikipedia.org/wiki/File:AceofBaseTheSignAlbumcover.jpg">Wikipedia</a></p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="progress-check" class="slide level1">
<h1>Progress Check</h1>
<p>Let's review our progress with our Card class design:</p>
<ul>
<li>We have a nice string representation of Card objects (<code>Card</code>).</li>
<li>We have encapsulated the rank and suit in private instance variables (<code>Card</code>) with mutator methods (<code>Card</code>) to set their values.</li>
<li>We validate the rank and suit in the mutator methods so we can't set invalid ranks and suits in Card objects (<code>Card</code>).</li>
<li><code>Card</code> has a constructor, which ensures that instance variables are initialized when an instance of <code>Card</code> is created.</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="static-members-card-v2.1" class="slide level1">
<h1>Static Members, Card v2.1</h1>
<p>Do we need a separate instance of <code>VALID_RANKS</code> and <code>VALID_SUITS</code> for each instance of our Card class?</p>
<p><code>static</code> members are shared with all instances of a class:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> String[] VALID_RANKS =
    {<span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>,
     <span class="st">&quot;10&quot;</span>, <span class="st">&quot;jack&quot;</span>, <span class="st">&quot;queen&quot;</span>, <span class="st">&quot;king&quot;</span>, <span class="st">&quot;ace&quot;</span>};
<span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> String[] VALID_SUITS =
    {<span class="st">&quot;diamonds&quot;</span>, <span class="st">&quot;clubs&quot;</span>, <span class="st">&quot;hearts&quot;</span>,<span class="st">&quot;spades&quot;</span>};</code></pre></div>
<p>Given the declarations above:</p>
<ul>
<li>Each instance shares a single copy of <code>VALID_RANKS</code> and a single copy of <code>VALID_SUITS</code></li>
<li>Since they're <code>final</code>, we can safely make them <code>public</code> so clients of our Card class can use them</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="one-final-enhancement" class="slide level1">
<h1>One Final Enhancement</h1>
<p><code>Card</code> v2.1 is pretty good, but we can write code like this:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Dealer {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        Card c = <span class="kw">new</span> <span class="fu">Card</span>(<span class="st">&quot;queen&quot;</span>, <span class="st">&quot;hearts&quot;</span>);
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
        c.<span class="fu">setRank</span>(<span class="st">&quot;jack&quot;</span>); <span class="co">// modifying c</span>
        System.<span class="fu">out</span>.<span class="fu">println</span>(c);
    }
}</code></pre></div>
<p>Does this make sense? Should Card objects be mutable?</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="immutable-objects" class="slide level1">
<h1>Immutable Objects</h1>
<p>Card objects don't change. We can model this behavior by removing the setters and putting the initialization code in the constructor (or making the setters private and calling them from the constructor):</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="fu">Card</span>(String aRank, String aSuit) { <span class="co">// constructor</span>
  <span class="kw">if</span> (!<span class="fu">isValidRank</span>(rank)) {
    System.<span class="fu">out</span>.<span class="fu">println</span>(aRank + <span class="st">&quot; is not a valid rank.&quot;</span>);
    System.<span class="fu">exit</span>(<span class="dv">0</span>);
  }
  rank = aRank;
  <span class="kw">if</span> (!<span class="fu">isValidSuit</span>(aSuit)) {
    System.<span class="fu">out</span>.<span class="fu">println</span>(aSuit + <span class="st">&quot; is not a valid suit.&quot;</span>);
    System.<span class="fu">exit</span>(<span class="dv">0</span>);
  }
  suit = aSuit;
}</code></pre></div>
<p>Note the use of another idiom for disambiguating constructor paramters from instance variables (as opposed to using <code>this</code>).</p>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="designing-immutable-classes" class="slide level1">
<h1>Designing Immutable Classes</h1>
<p>An immutable class is a class whose instances cannot be modified. To make a class immutable:</p>
<ul>
<li>Don't provide mutator methods (&quot;setters&quot;)</li>
<li>Make the class <code>final</code> so it can't be extended (there's another way to accomplish this, but making the class <code>final</code> is good enough for now)</li>
<li>Make all fields <code>final</code></li>
<li>Make all fields <code>private</code></li>
<li>For fields of mutable class types, return defensive copies in accessor methods (we'll discuss this later)</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="prefer-immutable-classes" class="slide level1">
<h1>Prefer Immutable Classes</h1>
<p>In general, make your classes immutable unless you have a good reason to make them mutable. Why? Because immutable objects</p>
<ul>
<li>are simpler to design because you don't have to worry about enforcing class invariants in multiple places,</li>
<li>are easier to reason about because the state of an object never changes after instantiation,</li>
<li>are inherently thread-safe because access to mutable data need not be syncronized, and</li>
<li>enable safe instance sharing, so redundant copies need not be created.</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="a-few-final-bits-of-polish" class="slide level1">
<h1>A Few Final Bits of Polish</h1>
<p>Take a look at the final evolution of our Card class. It contains a few more enhancements:</p>
<ul>
<li>Instead of simply terminating the program, the constructor throws <code>IllegalArgumentException</code> on invalid input so that client code can choose to deal with the exception at run-time.</li>
<li>Input is normalized to lower case and spaces trimmed to make the Card object robust to oddly formatted input.</li>
<li>It has an <code>equals()</code> method.</li>
</ul>
<!------------------------------------ Slide -------------------------------->
</section>
<section id="equality" class="slide level1">
<h1>Equality</h1>
<ul>
<li><code>==</code> means identity equality (aliasing) for reference types (objects).</li>
<li>The <code>equals(Object)</code> tests value equality for objects.</li>
</ul>
<p>Given our finished Card class with a properly implemented <code>equals(Object)</code> method, this code:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">  Card c1 = <span class="kw">new</span> <span class="fu">Card</span>(<span class="st">&quot;ace&quot;</span>, <span class="st">&quot;spades&quot;</span>);
  Card c2 = <span class="kw">new</span> <span class="fu">Card</span>(<span class="st">&quot;ace&quot;</span>, <span class="st">&quot;spades&quot;</span>);
  Card c3 = c1;
  System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;c1 == c2 returns &quot;</span> + (c1 == c2));
  System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;c1.equals(c2) returns &quot;</span> + c1.<span class="fu">equals</span>(c2));
  System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;c1 == c3 returns &quot;</span> + (c1 == c3));
  System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;c1.equals(c3) returns &quot;</span> + c1.<span class="fu">equals</span>(c3));</code></pre></div>
<p>produces this output:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">  c1 == c2 returns <span class="kw">false</span>
  c1.<span class="fu">equals</span>(c2) returns <span class="kw">true</span>
  c1 == c3 returns <span class="kw">true</span>
  c1.<span class="fu">equals</span>(c3) returns <span class="kw">true</span></code></pre></div>
<p>By the way, what if we left off the parentheses around <code>c1 == c2</code> in <code>System.out.println(&quot;c1 == c2 returns &quot; + (c1 == c2))</code>?</p>
</section>
<section id="exercise-treating-people-as-objects" class="slide level1">
<h1>Exercise: Treating People as Objects</h1>
<p>Using the encapsulation techniques we just learned, write a class named <code>Person</code> with a <code>name</code> field of type <code>String</code> and an <code>age</code> field of type <code>int</code>.</p>
<p>Write a suitable <code>toString</code> method for your <code>Person</code> class.</p>
<p>Add a main method that:</p>
<ul>
<li>Creates an array of <code>Person</code> objects</li>
<li>Iterates through the array and prints each Person object who's age is greater than 21</li>
</ul>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display a presentation progress bar
        progress: true,
        // Display the page number of the current slide
        slideNumber: 'c/t',

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
